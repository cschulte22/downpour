(function(c){function g(a){return a.siblings("div.downpour_select_box")}function h(a){var b=a.siblings("div.downpour_option_box");if(void 0===b||0==b.length)b=c("#"+k(a)).find("div.downpour_option_box");return b}function l(a){var b=g(a),d=h(a);b.removeClass("downpour_select_box_focus");d.find("div.downpour_row").off("mouseover.downpour");d.find("div.downpour_row").off("mouseout.downpour");d.find("div.downpour_row").off("click.downpour");c(document).off("keydown.downpour");c(document).off("click.downpour");
b=c("#"+k(a));a=a.parent("div.downpour_wrap");d.hide();d.appendTo(a);b.remove()}function s(a){if(27==a.which)i().downpour("blur"),a.preventDefault();else if(38==a.which){var b=h(i()),d=b.find("div.downpour_row_hover");0==d.length&&(d=b.find("div.downpour_row_selected"));var c=d.prevAll("div.downpour_row:not(.downpour_row_disabled)").first();0==c.length&&(c=b.find("div.downpour_row").last());d.removeClass("downpour_row_hover");c.addClass("downpour_row_hover");m(b,"up");a.preventDefault()}else 40==
a.which?(b=h(i()),d=b.find("div.downpour_row_hover"),0==d.length&&(d=b.find("div.downpour_row_selected")),c=d.nextAll("div.downpour_row:not(.downpour_row_disabled)").first(),0==c.length&&(c=b.find("div.downpour_row").first()),d.removeClass("downpour_row_hover"),c.addClass("downpour_row_hover"),m(b,"down"),a.preventDefault()):13==a.which&&(i().downpour("select"),a.preventDefault())}function i(){var a=c(".downpour_absolute").first().data("downpour_active_select");return void 0===a?[]:a}function m(a,
b){var d=a.find("div.downpour_row_hover");if(d){var c=a.scrollTop(),e=d.position().top+c,j=a.outerHeight(),d=d.outerHeight(),j=c+j,g=e+d,h=!1;e>=c&&(e<=j&&g<=j&&g>=c)&&(h=!0);if(!h){var i=a.find("div.downpour_row");a.find("div.downpour_row").off("mouseover.downpour");a.find("div.downpour_row").off("mouseout.downpour");"up"==b?(c=e-d,0>c&&(c=0),a.scrollTop(c)):a.scrollTop(e);window.setTimeout(function(){i.on("mouseover.downpour",p);i.on("mouseout.downpour",q)},400)}}}function r(a,b,d){var f=h(a),e=
null;a.find("option").each(function(){var a=c('<div class="downpour_row">'+c(this).html()+"</div>");a.data("downpour_value",c(this).attr("value"));b&&a.css({"white-space":"nowrap"});c(this).is(":disabled")?a.addClass("downpour_row_disabled"):c(this).is(":selected")&&(e=a);a.addClass(c(this).attr("class"));d&&""==c.trim(a.html())&&a.html("&nbsp;");f.append(a)});null!=e?g(a).html(e.html()):g(a).html("");return e}function p(){c(this).siblings("div.downpour_row_hover").removeClass("downpour_row_hover");
c(this).hasClass("downpour_row_disabled")||c(this).addClass("downpour_row_hover")}function q(){c(this).removeClass("downpour_row_hover")}function k(a){return"downpour_absolute_"+a.data("downpour").id}function t(){var a=0;c("div").each(function(){var b=parseInt(c(this).css("z-index"));b>a&&(a=b)});return a}var u={"class":"",nowrap:!1,auto_nbsp:!1},n={init:function(a){return this.each(function(){var b=c(this);a=c.extend({},u,a);var d=b.attr("id"),f=b.data("downpour")||{};if(f.id)return b;void 0===d&&
(d=(new Date).getTime()+"_"+Math.round(1E6*Math.random()));b.wrap('<div class="downpour_wrap"/>');var e=b.parent("div.downpour_wrap");e.css({position:"relative",overflow:"visible"});e.addClass(b.attr("class"));b.hide();e.append('<div class="downpour_select_box" />');g(b).css({position:"absolute",top:"0px",left:"0px",width:b.outerWidth()+"px"});g(b).on("click.downpour",function(a){a.stopPropagation();var a=c(this).siblings("select"),b=i();0==b.length||b==a?h(a).is(":visible")?a.downpour("blur"):a.downpour("focus"):
b.downpour("blur")});e.append('<div class="downpour_option_box" />');h(b).css({display:"none",position:"absolute",top:"0px",left:"0px","min-width":g(b).outerWidth()+"px","z-index":t()+1});var j=r(b,a.nowrap,a.auto_nbsp);e.css({height:g(b).outerHeight(),width:g(b).outerWidth()});f.id=d;f.settings=a;null!=j&&(f.selected=j.data("downpour_value"));b.data("downpour",f);return b})},focus:function(){return this.each(function(){var a=c(this),b=a.data("downpour"),d=g(a),f=h(a);if(!b.disabled&&!f.is(":visible")){d.addClass("downpour_select_box_focus");
f.css({top:d.outerHeight()+"px"});f.find("div.downpour_row_hover").removeClass("downpour_row_hover");f.find("div.downpour_row_selected").removeClass("downpour_row_selected");d=f.find("div.downpour_row");d.on("mouseover.downpour",p);d.on("mouseout.downpour",q);d.on("click.downpour",function(){i().downpour("select")});c(document).on("keydown.downpour",s);c(document).on("click.downpour",function(){i().downpour("blur")});void 0!==b.selected&&null!=b.selected&&f.find("div.downpour_row").each(function(){c(this).data("downpour_value")==
b.selected&&!c(this).hasClass("downpour_row_disabled")&&c(this).addClass("downpour_row_hover downpour_row_selected")});var d=a.parent("div.downpour_wrap"),e=c('<div id="'+k(a)+'" class="downpour_absolute"></div>');e.addClass(d.attr("class"));e.css({position:"absolute",top:d.offset().top,left:d.offset().left});f.appendTo(e);e.appendTo("body");e.data("downpour_active_select",a);f.show();m(f,"down")}})},blur:function(){return this.each(function(){var a=c(this);l(a);var b=a.data("downpour");void 0!==
b.settings.blur&&b.settings.blur.apply(a)})},select:function(){return this.each(function(){var a=c(this),b=h(a).find("div.downpour_row_hover");if(0<b.length){a.downpour("selected",b.data("downpour_value"));a.siblings("div.downpour_select_box").html(b.html());l(a);var d=a.data("downpour");void 0!==d.settings.select&&d.settings.select.apply(a,[b.data("downpour_value"),b.html()])}else a.downpour("blur")})},selected:function(a){return this.each(function(){var b=c(this),d=b.data("downpour");if(void 0===
a)return d.selected;d.selected=a;b.val(a)})},reload_options:function(){return this.each(function(){var a=c(this),b=a.data("downpour");h(a).empty();a=r(a,b.settings.nowrap,b.settings.auto_nbsp);null!=a&&(b.selected=a.data("downpour_value"))})},disable:function(){return this.each(function(){var a=c(this),b=a.data("downpour");b.disabled||(b.disabled=!0,l(a),g(a).addClass("downpour_disabled"))})},enable:function(){return this.each(function(){var a=c(this),b=a.data("downpour");b.disabled&&(b.disabled=
!1,g(a).removeClass("downpour_disabled"))})}};c.fn.downpour=function(a){if(n[a])return n[a].apply(this,Array.prototype.slice.call(arguments,1));if("object"===typeof a||!a)return n.init.apply(this,arguments);c.error("Method "+a+" does not exist on jQuery.downpour")}})(jQuery);